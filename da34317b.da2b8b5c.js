(window.webpackJsonp=window.webpackJsonp||[]).push([[57],{107:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return i})),n.d(t,"metadata",(function(){return l})),n.d(t,"rightToc",(function(){return b})),n.d(t,"default",(function(){return s}));var r=n(2),a=n(6),o=(n(0),n(124)),i={id:"gh-issue-sum-tutorial-p1",title:"GitHub Issue Summarization Example. Part 1"},l={unversionedId:"Kubeflow/user-tutorials/gh-issue-sum-tutorial-p1",id:"Kubeflow/user-tutorials/gh-issue-sum-tutorial-p1",isDocsHomePage:!1,title:"GitHub Issue Summarization Example. Part 1",description:"Training Keras Model with Jupyter",source:"@site/docs/Kubeflow/user-tutorials/kubeflow-github-issue-sum-training.md",slug:"/Kubeflow/user-tutorials/gh-issue-sum-tutorial-p1",permalink:"/mlops/docs/Kubeflow/user-tutorials/gh-issue-sum-tutorial-p1",editUrl:"https://github.com/nataliiaskopiuk/mlops/edit/master/docs/Kubeflow/user-tutorials/kubeflow-github-issue-sum-training.md",version:"current",sidebar:"someSidebar",previous:{title:"Login to Kubeflow Dashboard",permalink:"/mlops/docs/Kubeflow/user-tutorials/kf-ui-access"},next:{title:"GitHub Issue Summarization Example. Part 2",permalink:"/mlops/docs/Kubeflow/user-tutorials/gh-issue-sum-tutorial-p2"}},b=[{value:"Training Keras Model with Jupyter",id:"training-keras-model-with-jupyter",children:[]}],p={rightToc:b};function s(e){var t=e.components,i=Object(a.a)(e,["components"]);return Object(o.b)("wrapper",Object(r.a)({},p,i,{components:t,mdxType:"MDXLayout"}),Object(o.b)("h2",{id:"training-keras-model-with-jupyter"},"Training Keras Model with Jupyter"),Object(o.b)("p",null,Object(o.b)("em",{parentName:"p"},"Note:")," The following tutorial is based on the example ",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"https://github.com/mapr/kubeflow-examples/blob/master/github_issue_summarization/02_training_the_model.md"}),"here"),". "),Object(o.b)("p",null,"Upload the ",Object(o.b)("a",{target:"_blank",href:n(138).default},"kubeflow-tutorial.zip")," if you have not done that before."),Object(o.b)("ol",null,Object(o.b)("li",{parentName:"ol"},"Open Kubeflow Dashboard and click on ",Object(o.b)("strong",{parentName:"li"},"Notebook Servers")," item in the left menu.")),Object(o.b)("ol",{start:2},Object(o.b)("li",{parentName:"ol"},"Click on ",Object(o.b)("strong",{parentName:"li"},"New Server")," button.")),Object(o.b)("ol",{start:3},Object(o.b)("li",{parentName:"ol"},"Type in notebook server\u2019s name.")),Object(o.b)("ol",{start:4},Object(o.b)("li",{parentName:"ol"},Object(o.b)("p",{parentName:"li"},"Choose ",Object(o.b)("strong",{parentName:"p"},"Custom")," and set image:"),Object(o.b)("p",{parentName:"li"},Object(o.b)("inlineCode",{parentName:"p"},"gcr.io/mapr-252711/issue-summarization-notebook-cpu:latest")," "))),Object(o.b)("p",null,"In air gap: ",Object(o.b)("inlineCode",{parentName:"p"},"<registry_ip>:<port>/issue-summarization-notebook-cpu:latest")),Object(o.b)("ol",{start:5},Object(o.b)("li",{parentName:"ol"},"Leave ",Object(o.b)("strong",{parentName:"li"},"Workspace Volume")," as is. Specify at least ",Object(o.b)("inlineCode",{parentName:"li"},"16 Gi")," of memory. Add ",Object(o.b)("strong",{parentName:"li"},"New Data Volume"),", select  ",Object(o.b)("inlineCode",{parentName:"li"},"ReadWriteMany")," mode and change ",Object(o.b)("strong",{parentName:"li"},"Mount Point")," to a shorter name ",Object(o.b)("inlineCode",{parentName:"li"},"/data"),":\n",Object(o.b)("img",{alt:"Notebook Setup",src:n(179).default}))),Object(o.b)("ol",{start:6},Object(o.b)("li",{parentName:"ol"},"Launch the notebook server and wait until its running state. ")),Object(o.b)("p",null,Object(o.b)("em",{parentName:"p"},"Note:")," In case your environment has proxy values, you need to create and apply an egress.yaml file that will allow the newly created notebook to connect to the internet."),Object(o.b)("p",null,"Then apply the yaml file with  "),Object(o.b)("p",null,Object(o.b)("inlineCode",{parentName:"p"},"$ kubectl apply -f egress.yaml")),Object(o.b)("p",null,"Double check that the service entry was created properly by running the command: "),Object(o.b)("p",null,Object(o.b)("inlineCode",{parentName:"p"},"$ kubectl get ServiceEntry ")),Object(o.b)("ol",{start:7},Object(o.b)("li",{parentName:"ol"},"Connect to the notebook and open a new terminal. In the terminal clone repository with the notebook: ")),Object(o.b)("p",null,Object(o.b)("inlineCode",{parentName:"p"},"git clone https://github.com/mapr/kubeflow-examples.git")," "),Object(o.b)("p",null,Object(o.b)("em",{parentName:"p"},"Note:")," If your environment has proxy values, export proxy host before cloning the repo: "),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{}),"$ export http_proxy=<http_proxy_host> \n$ export https_proxy=<https_proxy_host> \n")),Object(o.b)("ol",{start:8},Object(o.b)("li",{parentName:"ol"},Object(o.b)("p",{parentName:"li"},"Go back to the folder list and open: "),Object(o.b)("p",{parentName:"li"},Object(o.b)("inlineCode",{parentName:"p"},"kubeflow-examples/github_issue_summarization/notebooks/Training.ipynb")))),Object(o.b)("ol",{start:9},Object(o.b)("li",{parentName:"ol"},Object(o.b)("p",{parentName:"li"},"In step \u201cSet path for data dir\u201d change data dir:"),Object(o.b)("p",{parentName:"li"},Object(o.b)("inlineCode",{parentName:"p"},"%env DATA_DIR=/data")," "))),Object(o.b)("ol",{start:10},Object(o.b)("li",{parentName:"ol"},"In \u201cPre-Process Data For Deep Learning\u201d section comment magic function ",Object(o.b)("inlineCode",{parentName:"li"},"%%time")," (known issue for the example).")),Object(o.b)("p",null,Object(o.b)("em",{parentName:"p"},"Note:")," In case of using proxy add environment variable in step 4 (\u201cDownload the github-issues.zip training data to /mnt/github-issues-data\u201d):"),Object(o.b)("p",null,"   ",Object(o.b)("inlineCode",{parentName:"p"},"%env https_proxy=<https_proxy_host>")," "),Object(o.b)("ol",{start:11},Object(o.b)("li",{parentName:"ol"},"Select ",Object(o.b)("strong",{parentName:"li"},"Cell > Run All")," to run all the steps or click Run button to run the notebook step by step manually. ")),Object(o.b)("ol",{start:12},Object(o.b)("li",{parentName:"ol"},"After training completes copy result files to HDFS. In the notebook\u2019s terminal: ")),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{}),"cd kubeflow-examples/github_issue_summarization/notebooks/ \ncp *.h5 /data/ \ncp *.dpkl /data/ \n")),Object(o.b)("p",null,"The following result files will be stored in HDFS:"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},Object(o.b)("p",{parentName:"li"},"seq2seq_model_tutorial.h5 - the keras model ")),Object(o.b)("li",{parentName:"ul"},Object(o.b)("p",{parentName:"li"},"body_pp.dpkl- the serialized body preprocessor ")),Object(o.b)("li",{parentName:"ul"},Object(o.b)("p",{parentName:"li"},"title_pp.dpkl- the serialized title preprocessor"))))}s.isMDXComponent=!0},124:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return d}));var r=n(0),a=n.n(r);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function b(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var p=a.a.createContext({}),s=function(e){var t=a.a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},c=function(e){var t=s(e.components);return a.a.createElement(p.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.a.createElement(a.a.Fragment,{},t)}},m=a.a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,i=e.parentName,p=b(e,["components","mdxType","originalType","parentName"]),c=s(n),m=r,d=c["".concat(i,".").concat(m)]||c[m]||u[m]||o;return n?a.a.createElement(d,l(l({ref:t},p),{},{components:n})):a.a.createElement(d,l({ref:t},p))}));function d(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=m;var l={};for(var b in t)hasOwnProperty.call(t,b)&&(l[b]=t[b]);l.originalType=e,l.mdxType="string"==typeof e?e:r,i[1]=l;for(var p=2;p<o;p++)i[p]=n[p];return a.a.createElement.apply(null,i)}return a.a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},138:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/files/kubeflow_tutorials_5.3-d2702c9f055fa88dc7dd4cb0330cd6f8.zip"},179:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/notebook-setup-4dc25eb53db505cf4686923f4f307287.png"}}]);