(window.webpackJsonp=window.webpackJsonp||[]).push([[46],{109:function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return u}));var a=n(0),i=n.n(a);function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},c=Object.keys(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var l=i.a.createContext({}),p=function(e){var t=i.a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},b=function(e){var t=p(e.components);return i.a.createElement(l.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return i.a.createElement(i.a.Fragment,{},t)}},m=i.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,c=e.originalType,o=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),b=p(n),m=a,u=b["".concat(o,".").concat(m)]||b[m]||d[m]||c;return n?i.a.createElement(u,r(r({ref:t},l),{},{components:n})):i.a.createElement(u,r({ref:t},l))}));function u(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var c=n.length,o=new Array(c);o[0]=m;var r={};for(var s in t)hasOwnProperty.call(t,s)&&(r[s]=t[s]);r.originalType=e,r.mdxType="string"==typeof e?e:a,o[1]=r;for(var l=2;l<c;l++)o[l]=n[l];return i.a.createElement.apply(null,o)}return i.a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},96:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return o})),n.d(t,"metadata",(function(){return r})),n.d(t,"rightToc",(function(){return s})),n.d(t,"default",(function(){return p}));var a=n(2),i=n(6),c=(n(0),n(109)),o={id:"configcli",title:"Config CLI"},r={unversionedId:"kd-img-dev/configcli",id:"kd-img-dev/configcli",isDocsHomePage:!1,title:"Config CLI",description:"When the startscript gets executed for a lifecycle event it will usually need to retrieve metadata about the environment so that you can control how the script reacts to the event.",source:"@site/docs/kd-img-dev/configcli.md",slug:"/kd-img-dev/configcli",permalink:"/mlops/docs/kd-img-dev/configcli",editUrl:"https://github.com/kmathur2/mlops/edit/master/docs/kd-img-dev/configcli.md",version:"current",sidebar:"someSidebar",previous:{title:"Config Package",permalink:"/mlops/docs/kd-img-dev/configpackage"},next:{title:"HPE Ezmeral CP (optional)",permalink:"/mlops/docs/kd-img-dev/hpecp_kd_app"}},s=[{value:"/etc/guestconfig/configmeta.json",id:"etcguestconfigconfigmetajson",children:[]},{value:"Exploring the Config CLI",id:"exploring-the-config-cli",children:[]},{value:"Using from a shell script",id:"using-from-a-shell-script",children:[]},{value:"Using from a Python script",id:"using-from-a-python-script",children:[]},{value:"Exercise",id:"exercise",children:[]},{value:"References",id:"references",children:[]}],l={rightToc:s};function p(e){var t=e.components,n=Object(i.a)(e,["components"]);return Object(c.b)("wrapper",Object(a.a)({},l,n,{components:t,mdxType:"MDXLayout"}),Object(c.b)("p",null,"When the ",Object(c.b)("inlineCode",{parentName:"p"},"startscript")," gets executed for a lifecycle event it will usually need to retrieve metadata about the environment so that you can control how the script reacts to the event."),Object(c.b)("p",null,"The Config CLI allows you to retrieve metadata."),Object(c.b)("h2",{id:"etcguestconfigconfigmetajson"},"/etc/guestconfig/configmeta.json"),Object(c.b)("p",null,"The metadata can be found in the pods in ",Object(c.b)("inlineCode",{parentName:"p"},"/etc/guestconfig/configmeta.json"),"."),Object(c.b)("h2",{id:"exploring-the-config-cli"},"Exploring the Config CLI"),Object(c.b)("p",null,"I wasn't able to find documentation on the Config CLI so let's do some exploring."),Object(c.b)("div",{className:"admonition admonition-info alert alert--info"},Object(c.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-heading"}),Object(c.b)("h5",{parentName:"div"},Object(c.b)("span",Object(a.a)({parentName:"h5"},{className:"admonition-icon"}),Object(c.b)("svg",Object(a.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"}),Object(c.b)("path",Object(a.a)({parentName:"svg"},{fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"})))),"Config CLI")),Object(c.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-content"}),Object(c.b)("p",{parentName:"div"},"The Config CLI is installed automatically in containers that have a config package."),Object(c.b)("p",{parentName:"div"},"If this exercise we use the Centos 7 MLOpsCluster running from the previous ",Object(c.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/kd-img-dev/configpackage"}),"lesson")," that has a config package defined:"),Object(c.b)("pre",{parentName:"div"},Object(c.b)("code",Object(a.a)({parentName:"pre"},{}),'{\n    ...\n    "defaultConfigPackage":  {\n        "packageURL": "file:///opt/configscripts/appconfig.tgz"\n    },\n    ...\n}\n')))),Object(c.b)("p",null,"You should still have your ",Object(c.b)("inlineCode",{parentName:"p"},"MLOpsCluster")," running from the previous ",Object(c.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/kd-img-dev/configpackage"}),"lesson")," if not, start it now."),Object(c.b)("p",null,"Next open a shell session on the cluster:"),Object(c.b)("pre",null,Object(c.b)("code",Object(a.a)({parentName:"pre"},{}),"kubectl exec -it your-pod-name -- /bin/bash\n")),Object(c.b)("p",null,"Now execute the configcli application:"),Object(c.b)("pre",null,Object(c.b)("code",Object(a.a)({parentName:"pre"},{}),"[root@kdss-xkdsh-0 /]# configcli \nConfiguration CLI 1.0.\n\nccli> \n")),Object(c.b)("p",null,"From here you can explore the help:"),Object(c.b)("pre",null,Object(c.b)("code",Object(a.a)({parentName:"pre"},{}),"ccli> help\n\nDocumented commands (type help <topic>):\n________________________________________\nEOF  baseimg  ccli  exit  help  macro  namespace\n")),Object(c.b)("p",null,"And ..."),Object(c.b)("pre",null,Object(c.b)("code",Object(a.a)({parentName:"pre"},{}),"ccli> help namespace\nusage: namespace [-h]\n                 {node,version,cluster,distros,services,tenant,auth,platform}\n                 ...\n\nAccess to all available configuration namespaces.\n\noptional arguments:\n  -h, --help            show this help message and exit\n\nSubcommands:\n  {node,version,cluster,distros,services,tenant,auth,platform}\n    node                The node namespace from the application configuration\n                        metadata\n    version             The version namespace from the application\n                        configuration metadata\n    cluster             The node namespace from the application configuration\n                        metadata\n    distros             The distros namespace from the application\n                        configuration metadata.\n    services            The services namespace from the application\n                        configuration metadata.\n    tenant              The tenant namespace from the application\n                        configuration metadata.\n    auth                The auth namespace from the application configuration\n                        metadata.\n    platform            The platform namespace from the application\n                        configuration metadata.\n")),Object(c.b)("p",null,"You can then retrieve specific information:"),Object(c.b)("pre",null,Object(c.b)("code",Object(a.a)({parentName:"pre"},{}),"ccli> namespace distros\nbluedata/centos7x\n")),Object(c.b)("p",null,"When we are done we can exit:"),Object(c.b)("pre",null,Object(c.b)("code",Object(a.a)({parentName:"pre"},{}),"ccli> exit\n\n\n[root@kdss-xkdsh-0 /]#\n")),Object(c.b)("div",{className:"admonition admonition-info alert alert--info"},Object(c.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-heading"}),Object(c.b)("h5",{parentName:"div"},Object(c.b)("span",Object(a.a)({parentName:"h5"},{className:"admonition-icon"}),Object(c.b)("svg",Object(a.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"}),Object(c.b)("path",Object(a.a)({parentName:"svg"},{fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"})))),"info")),Object(c.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-content"}),Object(c.b)("p",{parentName:"div"},"If some of the configcli commands do not work as expected, it could be due to the following ",Object(c.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/bluek8s/configcli/issues/1"}),"issue")))),Object(c.b)("h2",{id:"using-from-a-shell-script"},"Using from a shell script"),Object(c.b)("p",null,"From a shell appconfig script (e.g. startscript) you can call the configcli directly, e.g."),Object(c.b)("pre",null,Object(c.b)("code",Object(a.a)({parentName:"pre"},{}),"[root@kdss-xkdsh-0 /]# echo $(configcli namespace distros)\nbluedata/centos7x\n")),Object(c.b)("h2",{id:"using-from-a-python-script"},"Using from a Python script"),Object(c.b)("div",{className:"admonition admonition-info alert alert--info"},Object(c.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-heading"}),Object(c.b)("h5",{parentName:"div"},Object(c.b)("span",Object(a.a)({parentName:"h5"},{className:"admonition-icon"}),Object(c.b)("svg",Object(a.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"}),Object(c.b)("path",Object(a.a)({parentName:"svg"},{fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"})))),"info")),Object(c.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-content"}),Object(c.b)("p",{parentName:"div"},"App config scripts (e.g. startscript) can also be written in Python."),Object(c.b)("p",{parentName:"div"},"Information on writing startscript in Python is an advanced topic and will be covered later."))),Object(c.b)("h2",{id:"exercise"},"Exercise"),Object(c.b)("p",null,"Update the startscript from the previous ",Object(c.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/kd-img-dev/configpackage"}),"lesson")," to use the configcli in some way."),Object(c.b)("h2",{id:"references"},"References"),Object(c.b)("ul",null,Object(c.b)("li",{parentName:"ul"},"Config CLI ",Object(c.b)("a",Object(a.a)({parentName:"li"},{href:"https://github.com/bluek8s/configcli"}),"source code"))))}p.isMDXComponent=!0}}]);