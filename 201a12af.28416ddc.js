(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{112:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return f}));var o=n(0),r=n.n(o);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var b=r.a.createContext({}),u=function(e){var t=r.a.useContext(b),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},s=function(e){var t=u(e.components);return r.a.createElement(b.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},m=r.a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,i=e.parentName,b=c(e,["components","mdxType","originalType","parentName"]),s=u(n),m=o,f=s["".concat(i,".").concat(m)]||s[m]||p[m]||a;return n?r.a.createElement(f,l(l({ref:t},b),{},{components:n})):r.a.createElement(f,l({ref:t},b))}));function f(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,i=new Array(a);i[0]=m;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l.mdxType="string"==typeof e?e:o,i[1]=l;for(var b=2;b<a;b++)i[b]=n[b];return r.a.createElement.apply(null,i)}return r.a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},151:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/kf-diagram-6c400eba1208003e72a9428bc9e05e7a.png"},152:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/RBAC-ee5160e1cdb1b7d4063c7797f8358b65.png"},66:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return i})),n.d(t,"metadata",(function(){return l})),n.d(t,"rightToc",(function(){return c})),n.d(t,"default",(function(){return u}));var o=n(2),r=n(6),a=(n(0),n(112)),i={id:"kf-intro",title:"Kubeflow Introduction"},l={unversionedId:"Kubeflow/architecture/kf-intro",id:"Kubeflow/architecture/kf-intro",isDocsHomePage:!1,title:"Kubeflow Introduction",description:"Kubeflow",source:"@site/docs/Kubeflow/architecture/kubeflow-basics.md",slug:"/Kubeflow/architecture/kf-intro",permalink:"/mlops/docs/Kubeflow/architecture/kf-intro",editUrl:"https://github.com/nataliiaskopiuk/mlops/edit/master/docs/Kubeflow/architecture/kubeflow-basics.md",version:"current",sidebar:"someSidebar",previous:{title:"Kubeflow Components",permalink:"/mlops/docs/Kubeflow/architecture/kf-components"},next:{title:"Istio Prometheus",permalink:"/mlops/docs/Kubeflow/k8s-admin-tutorials/prometheus-tutorial"}},c=[{value:"Kubeflow",id:"kubeflow",children:[]},{value:"Conceptual overview",id:"conceptual-overview",children:[]},{value:"Kubeflow resources",id:"kubeflow-resources",children:[]},{value:"Kubeflow RBAC",id:"kubeflow-rbac",children:[]},{value:"Customization: Editing Kubeflow Manifests",id:"customization-editing-kubeflow-manifests",children:[]}],b={rightToc:c};function u(e){var t=e.components,i=Object(r.a)(e,["components"]);return Object(a.b)("wrapper",Object(o.a)({},b,i,{components:t,mdxType:"MDXLayout"}),Object(a.b)("h3",{id:"kubeflow"},"Kubeflow"),Object(a.b)("p",null,"Kubeflow is the machine learning (ML) toolkit for Kubernetes. It makes deployments of ML workflows on Kubernetes simple, portable and scalable.\nKubeflow includes:"),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},Object(a.b)("p",{parentName:"li"},"Services for spawning and managing Jupyter notebooks. Use notebooks for interactive data science and experimenting with ML workflows.")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("p",{parentName:"li"},"Kubeflow Pipelines is a platform for building, deploying, and managing multi-step ML workflows based on Docker containers.")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("p",{parentName:"li"},"Kubeflow offers several components that you can use to build your ML training, hyperparameter tuning, and serving workloads."))),Object(a.b)("h3",{id:"conceptual-overview"},"Conceptual overview"),Object(a.b)("p",null,"Kubeflow builds on Kubernetes as a system for deploying, scaling, and managing complex systems. The following diagram shows Kubeflow as a platform for arranging the components of your ML system on top of Kubernetes:"),Object(a.b)("p",null,Object(a.b)("img",{alt:"Kubeflow Diagram",src:n(151).default})),Object(a.b)("h3",{id:"kubeflow-resources"},"Kubeflow resources"),Object(a.b)("p",null,"Kubeflow is created and managed by Kubeflow Operator in ECP k8s Cluster."),Object(a.b)("p",null,"Kubeflow Operator is based on the ",Object(a.b)("a",Object(o.a)({parentName:"p"},{href:"https://github.com/kubeflow/kfctl/blob/master/operator.md"}),"open-source operator")," that is slightly modified.\nMore information about the open-source Operator can be found ",Object(a.b)("a",Object(o.a)({parentName:"p"},{href:"https://docs.google.com/document/d/1vNBZOM-gDMpwTbhx0EDU6lDpyUjc7vhT3bdOWWCRjdk/edit"}),"here"),"."),Object(a.b)("p",null,"The Kubeflow Operator is built on top of KfDef Custom Resource (CR). "),Object(a.b)("pre",null,Object(a.b)("code",Object(o.a)({parentName:"pre"},{}),"$ kubectl get kfdef -n kubeflow\n\nNAME       AGE\nkubeflow   4h36m\n")),Object(a.b)("p",null,"KfDef is a set of Kubernetes applications (resources) created by kustomize configurations. For example, Istio CRD:"),Object(a.b)("pre",null,Object(a.b)("code",Object(o.a)({parentName:"pre"},{}),"$ kubectl get kfdef -n kubeflow\n\n...\n    Name:      istio-crds\n    Kustomize Config:\n      Overlays:\n        grafana\n        kiali\n      Parameters:\n        Name:   namespace\n        Value:  istio-system\n        Name:   airgapRegistry\n      Repo Ref:\n        Name:  manifests\n        Path:  istio-1-3-1/istio-install-1-3-1\n...\n")),Object(a.b)("p",null,"Kubeflow operator pod sits in kubeflow-operator namespace."),Object(a.b)("pre",null,Object(a.b)("code",Object(o.a)({parentName:"pre"},{}),"$ kubectl get pods -n kubeflow-operator\n\nNAME                                      READY   STATUS      RESTARTS   AGE\ndex-cm-generator-hlxdf                    0/1     Completed   0          4h43m\nhpecpconfig-patch-gfxhh                   0/1     Completed   0          4h43m\nkubeflow-operator-68bdd75b8b-q5v8j        1/1     Running     1          4h43m\nlocal-path-provisioner-5fd8f5bbb8-5ksm6   1/1     Running     1          4h43m\n")),Object(a.b)("p",null,"Below are the pods created by Kubeflow operator in Kubeflow namespace."),Object(a.b)("pre",null,Object(a.b)("code",Object(o.a)({parentName:"pre"},{}),"$ kubectl get pods -n kubeflow\n\nNAME                                                        READY   STATUS    RESTARTS   AGE\nadmission-webhook-deployment-69c9b46895-rb678               1/1     Running   1          4h40m\napplication-controller-stateful-set-0                       1/1     Running   1          4h42m\nargo-ui-65df8c7c84-dkjmp                                    1/1     Running   1          4h40m\ncentraldashboard-5864774c5-ghrwq                            1/1     Running   1          4h40m\njupyter-web-app-deployment-7bd87b558b-zkjcs                 1/1     Running   1          4h40m\nkatib-controller-7fcc95676b-4kznm                           1/1     Running   2          4h40m\nkatib-db-manager-85db457c64-glxqh                           1/1     Running   2          4h40m\nkatib-mysql-6c7f7fb869-5bvr8                                1/1     Running   1          4h40m\nkatib-ui-65dc4cf6f5-tvmtv                                   1/1     Running   2          4h40m\nkfserving-controller-manager-0                              2/2     Running   2          4h40m\nmetadata-db-7bfd9f7d4b-db2bn                                1/1     Running   1          4h40m\nmetadata-envoy-deployment-56647cf45-hjl7f                   1/1     Running   1          4h40m\nmetadata-grpc-deployment-5989ffcc5-dhw6t                    1/1     Running   5          4h40m\nminio-5ff57fbbb-m9c9s                                       1/1     Running   1          4h40m\nml-pipeline-688c9d4947-mr2pb                                1/1     Running   2          4h40m\nml-pipeline-persistenceagent-5c5c8b5686-rwxqr               1/1     Running   5          4h40m\nml-pipeline-scheduledworkflow-55c7dd5c86-g2m9s              1/1     Running   1          4h40m\nml-pipeline-ui-66d4b66785-hh45n                             1/1     Running   1          4h40m\nml-pipeline-viewer-controller-deployment-6f588776c8-nb2qs   1/1     Running   1          4h40m\nml-pipeline-visualizationserver-699c5fd945-4gxf6            1/1     Running   1          4h40m\nmysql-7fcd5d4b9c-bqsg4                                      1/1     Running   1          4h40m\nnotebook-controller-deployment-75bdc8c9b8-6pcf7             1/1     Running   1          4h40m\nprofiles-deployment-84cd44986c-jb8kb                        2/2     Running   2          4h40m\npytorch-operator-6fcf6866cf-nrdvn                           1/1     Running   4          4h40m\nseldon-controller-manager-6bf8b45656-8r6hz                  1/1     Running   2          4h40m\nspartakus-volunteer-558f8bfd47-wsfg9                        1/1     Running   1          4h40m\ntf-job-operator-58477797f8-hnch2                            1/1     Running   4          4h40m\nworkflow-controller-64fd7cffc5-sfdtx                        1/1     Running   1          4h40m\nzeppelin-operator-864474fdd-r9nzt                           1/1     Running   1          4h40m\n")),Object(a.b)("p",null,"Kubeflow uses bootstrap scripts (there are ",Object(a.b)("a",Object(o.a)({parentName:"p"},{href:"https://github.com/mapr/private-kfctl/tree/v1.2.0-branch-mapr-5.3.0"}),"private")," and ",Object(a.b)("a",Object(o.a)({parentName:"p"},{href:"https://github.com/HPEEzmeral/kubeflow"}),"public")," GitHub repositories) to install kubeflow and related stuffs on ECP. Below are some kubernetes namespaces in which kubeflow operator creates resources."),Object(a.b)("p",null,Object(a.b)("inlineCode",{parentName:"p"},"auth")," - dex for OIDC support in kubeflow"),Object(a.b)("p",null,Object(a.b)("inlineCode",{parentName:"p"},"istio-system")," - istio service mesh"),Object(a.b)("p",null,Object(a.b)("inlineCode",{parentName:"p"},"knative-serving")," - knative resources to serve models"),Object(a.b)("p",null,Object(a.b)("inlineCode",{parentName:"p"},"kubeflow")," - different controllers to manage resources"),Object(a.b)("p",null,Object(a.b)("inlineCode",{parentName:"p"},"kubeflow-operator")," - kubeflow operator deployment and local path provisioner related resources"),Object(a.b)("p",null,"Also, there will be a namespace created per user to create Kubernetes resources."),Object(a.b)("h3",{id:"kubeflow-rbac"},"Kubeflow RBAC"),Object(a.b)("p",null,"Kubeflow uses 3 ",Object(a.b)("a",Object(o.a)({parentName:"p"},{href:"https://kubernetes.io/docs/reference/access-authn-authz/rbac/#aggregated-clusterroles"}),"aggregating cluster roles")," (kubeflow-admin, kubeflow-edit, kubeflow-view) "),Object(a.b)("p",null,Object(a.b)("img",{alt:"Kubeflow RBAC",src:n(152).default})),Object(a.b)("p",null,"For understanding how RBAC is implemented in Kubeflow follow the links bellow:",Object(a.b)("br",{parentName:"p"}),"\n",Object(a.b)("a",Object(o.a)({parentName:"p"},{href:"https://docs.google.com/document/d/11Xi-I2OqJvUuy_Zg0NskMF9GmworRDJhlu68poDgK5c/edit?pli=1#heading=h.anwlhplaqdmg"}),"design doc"),", ",Object(a.b)("a",Object(o.a)({parentName:"p"},{href:"https://github.com/yanniszark/kubeflow-community/blob/feature-auth-guideline/guidelines/auth.md"}),"community guideline"),", ",Object(a.b)("a",Object(o.a)({parentName:"p"},{href:"https://medium.com/kubeflow/enabling-kubeflow-with-enterprise-grade-auth-for-on-premise-deployments-ae7dd13a69e5"}),"blog post"),". "),Object(a.b)("h3",{id:"customization-editing-kubeflow-manifests"},"Customization: Editing Kubeflow Manifests"),Object(a.b)("p",null,"Kubeflow operator uses built-in manifests for deployment.",Object(a.b)("br",{parentName:"p"}),"\n","To provide the ability to modify them, a copy of manifests is being stored in the persistent volume, mounted via CSI driver.\nTo specify a path for local copy of manifests inside the operator path property was added.\nThe local path can be specified for each repository using path variable. By default, the following path is used: /mapr/kubeflow/manifests. "),Object(a.b)("p",null,"How it works: "),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},Object(a.b)("p",{parentName:"li"},"If there are files in local directory (mounted via CSI), then copying them to cache directory and ignoring built-in manifests. ")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("p",{parentName:"li"},"If local directory (mounted via CSI) is empty or does not exist, then copying to local directory manifests which are built in. ")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("p",{parentName:"li"},"If operator failed to access or copy files to local directory, then built-in manifests would be used. ")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("p",{parentName:"li"},"Local directory can be specified via path property with URI for each repository. ")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("p",{parentName:"li"},"If path property is not set, then working as it worked before. "))),Object(a.b)("p",null,"How to access manifests: "),Object(a.b)("p",null,Object(a.b)("inlineCode",{parentName:"p"},"$ kubectl get pvc kubeflow-operator-manifests -n kubeflow-operator")),Object(a.b)("p",null,"copy volume name, then: "),Object(a.b)("p",null,Object(a.b)("inlineCode",{parentName:"p"},"$ kubectl describe pv <volume>"),"  "),Object(a.b)("p",null,"copy volumePath and access it on the k8s master node (if using Embedded HPE Ezmeral Data Fabric as a storage): "),Object(a.b)("pre",null,Object(a.b)("code",Object(o.a)({parentName:"pre"},{}),"$ bdmapr --root bash\n$ cd mapr/mnt/hcp.mapr.cluster/<volumePath>/kubeflow/manifests/\n")),Object(a.b)("p",null,"In case of using HPE Ezmeral Data Fabric for Kubernetes cluster access tenantcli-0 pod on the K8S master node: "),Object(a.b)("pre",null,Object(a.b)("code",Object(o.a)({parentName:"pre"},{}),"$ kubectl -n <tenant_namespace> exec -it tenantcli-0 -- su - mapr\n$ maprlogin password\n$ hadoop fs -ls /<volumePath>/kubeflow/manifests/\n")))}u.isMDXComponent=!0}}]);